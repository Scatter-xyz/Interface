(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[499],{304:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/fractionalise",function(){return c(4129)}])},4129:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return u}});var d=c(7568),e=c(4051),f=c.n(e),g=c(5893);c(9669);var h,i=c(5675),j=c.n(i),k=c(8019),l=c(6076),m=c(7294),n=c(3678),o=c(3609),p=JSON.parse('[{"inputs":[{"internalType":"address payable","name":"_nftVaultContract","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"MAX_FRACTION_COUNT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"destroy","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_nftContractAddress","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"uint256","name":"fractionCount","type":"uint256"}],"name":"fractionalize","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"nftVaultContract","outputs":[{"internalType":"contract NftVault","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address payable","name":"_newnftVaultContract","type":"address"}],"name":"upgradeNFTContract","outputs":[],"stateMutability":"nonpayable","type":"function"},{"stateMutability":"payable","type":"receive"}]'),q=JSON.parse('[{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"approved","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"operator","type":"address"},{"indexed":false,"internalType":"bool","name":"approved","type":"bool"}],"name":"ApprovalForAll","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"approve","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"balance","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getApproved","outputs":[{"internalType":"address","name":"operator","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"operator","type":"address"}],"name":"isApprovedForAll","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"ownerOf","outputs":[{"internalType":"address","name":"owner","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"operator","type":"address"},{"internalType":"bool","name":"_approved","type":"bool"}],"name":"setApprovalForAll","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"transferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"}]'),r=o.Pt,s=(h=(0,d.Z)(f().mark(function a(b){var c,d,e,g,h,i,j,k,m,n,r;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=b.walletContext,d=b.contractAddress,e=b.tokenID,g=b.tokenCount,h=new l.CH(o.tm,p,c.provider),a.next=4,h.connect(c.signer);case 4:return i=a.sent,j=new l.CH(d,q,c.provider),a.next=8,j.connect(c.signer);case 8:return k=a.sent,a.next=11,k.getApproved(e);case 11:if(m=a.sent,console.log("Approver is: ",m),!(m.toLowerCase()!==o.tm.toLowerCase())){a.next=21;break}return a.next=16,k.approve(o.tm,e);case 16:n=a.sent,console.log("Transcation Receipt: ",n),n.hash,a.next=27;break;case 21:return console.log("Can fractionalise now!"),a.next=24,i.fractionalize(d,e,g);case 24:r=a.sent,console.log("Transcation Receipt: ",r),r.hash;case 27:case"end":return a.stop()}},a)})),function(a){return h.apply(this,arguments)}),t=function(a){var b=a.walletNFTsList,c=a.walletContext,d=function(a,b){return a.set(b.key,b.value)},e=(0,m.useReducer)(d,new Map([])),f=e[0],h=e[1],i=function(a){var b=a.key,d=a.contractAddress,e=a.tokenID,g=f.get(b);console.log("Fraction Count: ",g," Contract: ",d," TokenID: ",e),g<=0||g>r?o.Pt:c&&s({walletContext:c,contractAddress:d,tokenID:e,tokenCount:g})};return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("div",{className:"p-20 z-0",children:(0,g.jsxs)("div",{className:"flex flex-rows",children:[(0,g.jsx)("div",{className:"flex-1"}),(0,g.jsx)("div",{className:"grid grid-cols-3 gap-20",children:(void 0===b?[]:b).map(function(a){return(0,g.jsxs)("div",{className:"rounded-lg shadow-lg bg-white max-w-sm",children:[(0,g.jsx)("div",{className:"m-h-60",children:(0,g.jsx)(j(),{className:"rounded-t-lg",src:a.nftImage,alt:""})}),(0,g.jsxs)("div",{className:"p-6",children:[(0,g.jsxs)("div",{className:"flex flex-row",children:[(0,g.jsx)("p",{className:"text-emerald-700 text-sm font-semibold mb-2",children:"Original Address: "}),(0,g.jsx)("div",{className:"flex-1"}),(0,g.jsxs)("a",{className:"text-sm text-emerald-900 hover:text-emerald-700",href:"https://rinkeby.etherscan.io/address/".concat(a.originalAddress),rel:"noreferrer",target:"_blank",children:[a.originalAddress.substring(0,6)+"..."+a.originalAddress.substring(a.originalAddress.length-6,a.originalAddress.length)," "]})]}),(0,g.jsxs)("div",{className:"flex flex-row",children:[(0,g.jsx)("p",{className:"text-emerald-700 text-sm font-semibold mb-2",children:"Token Id:"}),(0,g.jsx)("div",{className:"flex-1"}),(0,g.jsx)("p",{className:"text-sm text-emerald-900",children:a.tokenID})]}),(0,g.jsxs)("div",{className:"flex flex-row",children:[(0,g.jsx)("p",{className:"text-emerald-700 text-sm font-semibold mb-2",children:"Fraction Count:"}),(0,g.jsx)("div",{className:"flex-1"}),(0,g.jsx)("input",{value:f.get(a.originalAddress+"-"+a.tokenID),onChange:function(b){return h({value:b.target.value,key:a.originalAddress+"-"+a.tokenID})},min:"1",max:r,className:"min-w-0 block w-28 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-emerald-900 focus:outline-none",type:"number",name:"fractionCount",required:!0})]}),(0,g.jsx)("div",{className:"relative grid place-items-center h-full mb-12 mt-16",children:(0,g.jsx)("button",{type:"button",onClick:function(){return i({key:a.originalAddress+"-"+a.tokenID,contractAddress:a.originalAddress,tokenID:a.tokenID})},className:"absolute font-sans px-12 py-4 bg-stiletto-500 hover:bg-stiletto-600 text-white font-semibold text-l uppercase rounded",children:"Fractionalise"})})]})]},a.originalAddress+"-"+a.tokenID)})}),(0,g.jsx)("div",{className:"flex-1"})]})})})},u=function(){var a=(0,m.useState)(),b=a[0],c=a[1],d=(0,m.useState)([]),e=d[0],f=d[1];return(0,m.useEffect)(function(){if(b&&!b.error){var a,c,d,e;a=b.address,c=f,d=[],(e=new Headers).append("Content-Type","application/json"),fetch("https://eth-rinkeby.alchemyapi.io/v2/9QLQtE0COOGdYHOSbo43OOYPqZ_Fw2OM/getNFTs/?owner=".concat(a),{method:"GET",headers:e,redirect:"follow"}).then(function(a){return a.json()}).then(function(a){a.ownedNfts.map(function(a){a.id.tokenMetadata.tokenType===o.Mt&&d.push({nftImage:a.media[0].gateway,originalAddress:a.contract.address,tokenID:parseInt(a.id.tokenId,16)})}),c(d)}).catch(function(a){return console.log("error",a)})}},[b]),(0,g.jsxs)("div",{className:"w-full min-h-content bg-gin-50",children:[(0,g.jsx)(k.Z,{pageLoad:"Fractionalise",setWalletContext:c}),(0,g.jsx)("div",{className:"pt-10 min-h-screen z-10",children:(0,g.jsx)(t,{walletNFTsList:e,walletContext:b})}),(0,g.jsx)(n.FooterData,{})]})}}},function(a){a.O(0,[651,675,822,325,774,888,179],function(){var b;return a(a.s=304)}),_N_E=a.O()}])